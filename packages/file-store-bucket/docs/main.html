<!DOCTYPE html>
<html><head title="Doc"><meta charset="UTF-8"/><link href="styles.css" rel="stylesheet"/></head><body><nav class="sidebar"><h3>Modules</h3><ul><li><li><a href="Batch.html">Batch</a></li></li><li><li><a href="Utils.html">Utils</a></li></li><li><li><a href="main.html">main</a></li></li></ul><h3>Declarations</h3><ul><li><li><a href="#register_user_by_backend">register_user_by_backend</a></li></li><li><li><a href="#is_user_registered">is_user_registered</a></li></li><li><li><a href="#create_batch">create_batch</a></li></li><li><li><a href="#upload_chunk">upload_chunk</a></li></li><li><li><a href="#get_stored_files">get_stored_files</a></li></li><li><li><a href="#get">get</a></li></li><li><li><a href="#get_chunk">get_chunk</a></li></li><li><li><a href="#list">list</a></li></li></ul></nav><div class="documentation"><h1>main</h1><div class="declaration"><h4 class="function" id="register_user_by_backend"><code><span class="keyword">public func </span><span class="fnname">register_user_by_backend</span>(<span class="parameter">user</span> : <span class="type">Principal</span>) : <span class="keyword">async </span>()</code></h4><p><ul><li>Registers a new user principal, allowing them to upload files.<ul><li>This function can only be called by the designated backend canister.</li><li>Traps if the caller is not the backend canister or if the user principal is anonymous.</li><li>@param user The principal of the user to register.</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="is_user_registered"><code><span class="keyword">public func </span><span class="fnname">is_user_registered</span>() : <span class="keyword">async </span><span class="type">Bool</span></code></h4><p><ul><li>Checks if the calling user is already registered.<ul><li>@return Returns <code>true</code> if the caller is registered, <code>false</code> otherwise.</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="create_batch"><code><span class="keyword">public func </span><span class="fnname">create_batch</span>(<span class="parameter">args</span> : <a href="#type.BatchArg"><span class="type">BatchArg</span></a>) : <span class="keyword">async </span><a href="#type.BatchId"><span class="type">BatchId</span></a></code></h4><p><ul><li>Creates a new batch for a file upload.<ul><li>A batch represents a file upload session and holds the file metadata and chunks.</li><li>The caller must be a registered user.</li><li>@param args Metadata for the file being uploaded, including chunk hashes, file name, and content type.</li><li>@return Returns a unique <code>BatchId</code> for the created batch.</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="upload_chunk"><code><span class="keyword">public func </span><span class="fnname">upload_chunk</span>() : <span class="keyword">async </span>()</code></h4><p><ul><li>Uploads a single chunk of a file to a previously created batch.<ul><li>The caller must be the same principal who created the batch.</li><li>@param uploadArg An object containing the <code>batchId</code> and the file <code>chunk</code> (as a Blob).</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="get_stored_files"><code><span class="keyword">public func </span><span class="fnname">get_stored_files</span>() : <span class="keyword">async </span>[(<span class="type">Text</span>, <a href="#type.File"><span class="type">File</span></a>)]</code></h4><p><ul><li>Retrieves the entire list of stored files.<ul><li>This is an admin-only function. The caller must be the admin principal.</li><li>@return Returns an array of tuples, where each tuple contains the file name and the file data.</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="get"><code><span class="keyword">public func </span><span class="fnname">get</span>({ <span class="parameter">file_name</span> : <a href="#type.FileName"><span class="type">FileName</span></a> }) : <span class="keyword">async </span>{ modified : <span class="type">Nat64</span>; content_type : <span class="type">Text</span>; content : <span class="type">Blob</span>; sha256 : ?<span class="type">Blob</span>; chunks_left : <span class="type">Nat</span> }</code></h4><p><ul><li>Retrieves the first chunk and metadata of a specific file.<ul><li>This is an admin-only function.</li><li>@param file_name The name of the file to retrieve.</li><li>@return Returns an object containing the file's metadata and the first chunk of its content.</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="get_chunk"><code><span class="keyword">public func </span><span class="fnname">get_chunk</span>({ <span class="parameter">file_name</span> : <a href="#type.FileName"><span class="type">FileName</span></a>; <span class="parameter">index</span> : <span class="type">Nat</span> }) : <span class="keyword">async </span>{ content : <span class="type">Blob</span> }</code></h4><p><ul><li>Retrieves a specific chunk of a file by its index.<ul><li>This is an admin-only function.</li><li>@param file_name The name of the file.</li><li>@param index The index of the chunk to retrieve.</li><li>@return Returns an object containing the requested chunk's content.</li></ul></li></ul></p></div><div class="declaration"><h4 class="function" id="list"><code><span class="keyword">public func </span><span class="fnname">list</span>() : <span class="keyword">async </span>[<a href="#type.FileInfo"><span class="type">FileInfo</span></a>]</code></h4><p><ul><li>Lists all stored files along with their metadata.<ul><li>This is an admin-only function.</li><li>@return Returns an array of <code>FileInfo</code> objects, each containing metadata about a stored file.</li></ul></li></ul></p></div></div></body></html>